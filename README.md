# koishi-plugin-stock

一个Koishi插件，当用户发送特定命令时自动获取股票数据并显示结果。支持活跃市值、异动分析、涨停看板和选股功能，并提供指令级黑名单配置。

## 功能

- 用户发送"活跃市值"命令时，自动从 `indexes`API获取数据并格式化显示
- 用户发送"异动 [股票代码]"命令时，自动从 `analyze`API获取指定股票的异动分析数据
- 用户发送"涨停看板"命令时，自动从 `limit_up`API下载图片并显示
- 用户发送"选股 [策略名称]"命令时，自动从 `dyq_select` API获取选股结果
- 用户发送"骑"命令时，自动返回 `images/qi.jpeg` 图片
- 支持为每个指令单独设置黑名单，可限制特定用户使用特定功能
- 自动格式化数据显示给用户

## 安装

```bash
npm install koishi-plugin-stock
```

## 配置

此插件支持以下配置选项：

- `allCommandsBlacklist`: 全部指令黑名单用户ID数组
- `activeMarketCapBlacklist`: 活跃市值指令黑名单用户ID数组
- `stockAlertBlacklist`: 异动指令黑名单用户ID数组
- `limitUpBoardBlacklist`: 涨停看板指令黑名单用户ID数组
- `stockSelectionBlacklist`: 选股指令黑名单用户ID数组
- `rideBlacklist`: 骑指令黑名单用户ID数组

## 使用

- 发送"活跃市值"获取最新的市场指数数据
- 发送"异动 [股票代码]"获取指定股票的异动分析，如"异动 000001"
- 发送"涨停看板"获取涨停股票看板图片
- 发送"选股 [策略名称或编号]"获取选股结果，支持的策略：N型(1)、填坑(2)、少妇(3)、突破(4)、补票(5)、少妇pro(6)
- 发送"骑"获取图片

配置黑名单可在插件设置中进行，将特定用户ID添加到相应指令的黑名单中即可限制其使用权限。

## 更新日志

### v1.0.10
- 修复了"骑"指令，使用本地图片路径并返回base64编码的图片

### v1.0.9
- 添加了"骑"指令，可返回本地图片

### v1.0.8
- 添加了指令级黑名单功能，可为每个指令单独设置黑名单

### v1.0.7
- 修复了一些小问题

### v1.0.6
- 优化了部分功能

### v1.0.5
- 添加了选股功能的数字编号支持

### v1.0.4
- 添加了选股功能的数字编号（1-6对应不同策略）

### v1.0.3
- 添加了选股功能，支持多种选股策略

### v1.0.2
- 添加了涨停看板功能

### v1.0.1
- 初始版本，包含活跃市值和异动分析功能